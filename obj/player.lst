                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.2 #13350 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module player
                                      6 	.optsdcc -msm83
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _joypad
                                     12 	.globl _joypadPrevious
                                     13 	.globl _joypadCurrent
                                     14 	.globl _mouse_metasprites
                                     15 	.globl _mouse_right1
                                     16 	.globl _mouse_right0
                                     17 	.globl _mouse_up
                                     18 	.globl _mouse_down
                                     19 	.globl _PlayerUpdate
                                     20 	.globl _DrawPlayer
                                     21 ;--------------------------------------------------------
                                     22 ; special function registers
                                     23 ;--------------------------------------------------------
                                     24 ;--------------------------------------------------------
                                     25 ; ram data
                                     26 ;--------------------------------------------------------
                                     27 	.area _DATA
                                     28 ;--------------------------------------------------------
                                     29 ; ram data
                                     30 ;--------------------------------------------------------
                                     31 	.area _INITIALIZED
      000000                         32 _joypadCurrent::
      000000                         33 	.ds 1
      000001                         34 _joypadPrevious::
      000001                         35 	.ds 1
                                     36 ;--------------------------------------------------------
                                     37 ; absolute external ram data
                                     38 ;--------------------------------------------------------
                                     39 	.area _DABS (ABS)
                                     40 ;--------------------------------------------------------
                                     41 ; global & static initialisations
                                     42 ;--------------------------------------------------------
                                     43 	.area _HOME
                                     44 	.area _GSINIT
                                     45 	.area _GSFINAL
                                     46 	.area _GSINIT
                                     47 ;--------------------------------------------------------
                                     48 ; Home
                                     49 ;--------------------------------------------------------
                                     50 	.area _HOME
                                     51 	.area _HOME
                                     52 ;--------------------------------------------------------
                                     53 ; code
                                     54 ;--------------------------------------------------------
                                     55 	.area _CODE
                                     56 ;src\player.c:11: void PlayerUpdate(struct player *ptr)
                                     57 ;	---------------------------------
                                     58 ; Function PlayerUpdate
                                     59 ; ---------------------------------
      000000                         60 _PlayerUpdate::
      000000 4B               [ 4]   61 	ld	c, e
      000001 42               [ 4]   62 	ld	b, d
                                     63 ;src\player.c:14: switch (ptr->playerState)
      000002 21 07 00         [12]   64 	ld	hl, #0x0007
      000005 09               [ 8]   65 	add	hl, bc
      000006 7E               [ 8]   66 	ld	a, (hl)
      000007 B7               [ 4]   67 	or	a, a
      000008 C0               [20]   68 	ret	NZ
                                     69 ;src\player.c:17: joypadPrevious = joypadCurrent;
      000009 FAr00r00         [16]   70 	ld	a, (#_joypadCurrent)
      00000C EAr01r00         [16]   71 	ld	(#_joypadPrevious),a
                                     72 ;src\player.c:18: joypadCurrent = joypad();
      00000F CDr00r00         [24]   73 	call	_joypad
      000012 21r00r00         [12]   74 	ld	hl, #_joypadCurrent
      000015 77               [ 8]   75 	ld	(hl), a
                                     76 ;src\player.c:17: joypadPrevious = joypadCurrent;
      000016 5E               [ 8]   77 	ld	e, (hl)
                                     78 ;src\player.c:22: ptr->playerDirection = up;
      000017 21 06 00         [12]   79 	ld	hl, #0x0006
      00001A 09               [ 8]   80 	add	hl, bc
                                     81 ;src\player.c:19: if (joypadCurrent & J_UP)
      00001B CB 53            [ 8]   82 	bit	2, e
      00001D 28 03            [12]   83 	jr	Z, 00111$
                                     84 ;src\player.c:22: ptr->playerDirection = up;
      00001F 36 01            [12]   85 	ld	(hl), #0x01
      000021 C9               [16]   86 	ret
      000022                         87 00111$:
                                     88 ;src\player.c:24: else if (joypadCurrent & J_DOWN)
      000022 CB 5B            [ 8]   89 	bit	3, e
      000024 28 03            [12]   90 	jr	Z, 00108$
                                     91 ;src\player.c:27: ptr->playerDirection = down;
      000026 36 00            [12]   92 	ld	(hl), #0x00
      000028 C9               [16]   93 	ret
      000029                         94 00108$:
                                     95 ;src\player.c:29: else if (joypadCurrent & J_RIGHT)
      000029 CB 43            [ 8]   96 	bit	0, e
      00002B 28 03            [12]   97 	jr	Z, 00105$
                                     98 ;src\player.c:32: ptr->playerDirection = right;
      00002D 36 02            [12]   99 	ld	(hl), #0x02
      00002F C9               [16]  100 	ret
      000030                        101 00105$:
                                    102 ;src\player.c:34: else if (joypadCurrent & J_LEFT)
      000030 CB 4B            [ 8]  103 	bit	1, e
      000032 C8               [20]  104 	ret	Z
                                    105 ;src\player.c:37: ptr->playerDirection = left;
      000033 36 03            [12]  106 	ld	(hl), #0x03
                                    107 ;src\player.c:43: }
                                    108 ;src\player.c:44: }
      000035 C9               [16]  109 	ret
                                    110 ;src\player.c:71: void DrawPlayer(struct player *ptr, uint8_t joy)
                                    111 ;	---------------------------------
                                    112 ; Function DrawPlayer
                                    113 ; ---------------------------------
      000036                        114 _DrawPlayer::
      000036 E8 FD            [16]  115 	add	sp, #-3
                                    116 ;src\player.c:75: switch (ptr->playerDirection)
      000038 21 06 00         [12]  117 	ld	hl, #0x0006
      00003B 19               [ 8]  118 	add	hl, de
      00003C 7E               [ 8]  119 	ld	a, (hl)
      00003D F8 00            [12]  120 	ldhl	sp,	#0
      00003F 77               [ 8]  121 	ld	(hl), a
                                    122 ;src\player.c:78: move_metasprite(mouse_metasprites[1], 0, 0, ptr->x, ptr->y);
      000040 4B               [ 4]  123 	ld	c, e
      000041 42               [ 4]  124 	ld	b, d
      000042 03               [ 8]  125 	inc	bc
      000043 03               [ 8]  126 	inc	bc
      000044 1A               [ 8]  127 	ld	a, (de)
      000045 F8 02            [12]  128 	ldhl	sp,	#2
      000047 32               [ 8]  129 	ld	(hl-), a
      000048 0A               [ 8]  130 	ld	a, (bc)
                                    131 ;src\player.c:75: switch (ptr->playerDirection)
      000049 32               [ 8]  132 	ld	(hl-), a
      00004A 7E               [ 8]  133 	ld	a, (hl)
      00004B B7               [ 4]  134 	or	a, a
      00004C 28 3B            [12]  135 	jr	Z, 00102$
      00004E F8 00            [12]  136 	ldhl	sp,	#0
      000050 7E               [ 8]  137 	ld	a, (hl)
      000051 3D               [ 4]  138 	dec	a
      000052 28 11            [12]  139 	jr	Z, 00101$
      000054 F8 00            [12]  140 	ldhl	sp,	#0
      000056 7E               [ 8]  141 	ld	a, (hl)
      000057 D6 02            [ 8]  142 	sub	a, #0x02
      000059 28 4F            [12]  143 	jr	Z, 00103$
      00005B F8 00            [12]  144 	ldhl	sp,	#0
      00005D 7E               [ 8]  145 	ld	a, (hl)
      00005E D6 03            [ 8]  146 	sub	a, #0x03
      000060 28 6B            [12]  147 	jr	Z, 00104$
      000062 C3rF3r00         [16]  148 	jp	00105$
                                    149 ;src\player.c:77: case up:
      000065                        150 00101$:
                                    151 ;src\player.c:78: move_metasprite(mouse_metasprites[1], 0, 0, ptr->x, ptr->y);
      000065 F8 01            [12]  152 	ldhl	sp,	#1
      000067 2A               [ 8]  153 	ld	a, (hl+)
      000068 47               [ 4]  154 	ld	b, a
      000069 4E               [ 8]  155 	ld	c, (hl)
      00006A 21r4Dr01         [12]  156 	ld	hl, #(_mouse_metasprites + 2) + 1
      00006D 3A               [ 8]  157 	ld	a,	(hl-)
                                    158 ;	spillPairReg hl
                                    159 ;C:/gbdk/include/gb/metasprites.h:140: __current_metasprite = metasprite;
      00006E 5E               [ 8]  160 	ld	e, (hl)
      00006F 57               [ 4]  161 	ld	d, a
      000070 21r00r00         [12]  162 	ld	hl, #___current_metasprite
      000073 7B               [ 4]  163 	ld	a, e
      000074 22               [ 8]  164 	ld	(hl+), a
      000075 72               [ 8]  165 	ld	(hl), d
                                    166 ;C:/gbdk/include/gb/metasprites.h:141: __current_base_tile = base_tile;
      000076 21r00r00         [12]  167 	ld	hl, #___current_base_tile
      000079 36 00            [12]  168 	ld	(hl), #0x00
                                    169 ;C:/gbdk/include/gb/metasprites.h:142: return __move_metasprite(base_sprite, x, y);
      00007B C5               [16]  170 	push	bc
      00007C 33               [ 8]  171 	inc	sp
      00007D 61               [ 4]  172 	ld	h, c
      00007E 2E 00            [ 8]  173 	ld	l, #0x00
      000080 E5               [16]  174 	push	hl
      000081 CDr00r00         [24]  175 	call	___move_metasprite
      000084 E8 03            [16]  176 	add	sp, #3
                                    177 ;src\player.c:79: break;
      000086 C3r17r01         [16]  178 	jp	00112$
                                    179 ;src\player.c:80: case down:
      000089                        180 00102$:
                                    181 ;src\player.c:81: move_metasprite(mouse_metasprites[0], 0, 0, ptr->x, ptr->y);
      000089 21r4Ar01         [12]  182 	ld	hl, #_mouse_metasprites
      00008C 2A               [ 8]  183 	ld	a, (hl+)
      00008D 4F               [ 4]  184 	ld	c, a
      00008E 7E               [ 8]  185 	ld	a, (hl)
                                    186 ;C:/gbdk/include/gb/metasprites.h:140: __current_metasprite = metasprite;
      00008F 21r00r00         [12]  187 	ld	hl, #___current_metasprite
      000092 71               [ 8]  188 	ld	(hl), c
      000093 23               [ 8]  189 	inc	hl
      000094 77               [ 8]  190 	ld	(hl), a
                                    191 ;C:/gbdk/include/gb/metasprites.h:141: __current_base_tile = base_tile;
      000095 21r00r00         [12]  192 	ld	hl, #___current_base_tile
      000098 36 00            [12]  193 	ld	(hl), #0x00
                                    194 ;C:/gbdk/include/gb/metasprites.h:142: return __move_metasprite(base_sprite, x, y);
      00009A F8 01            [12]  195 	ldhl	sp,	#1
      00009C 2A               [ 8]  196 	ld	a, (hl+)
      00009D F5               [16]  197 	push	af
      00009E 33               [ 8]  198 	inc	sp
      00009F 66               [ 8]  199 	ld	h, (hl)
      0000A0 2E 00            [ 8]  200 	ld	l, #0x00
      0000A2 E5               [16]  201 	push	hl
      0000A3 CDr00r00         [24]  202 	call	___move_metasprite
      0000A6 E8 03            [16]  203 	add	sp, #3
                                    204 ;src\player.c:82: break;
      0000A8 18 6D            [12]  205 	jr	00112$
                                    206 ;src\player.c:83: case right:
      0000AA                        207 00103$:
                                    208 ;src\player.c:84: move_metasprite(mouse_metasprites[3], 0, 0, ptr->x, ptr->y);
      0000AA F8 01            [12]  209 	ldhl	sp,	#1
      0000AC 2A               [ 8]  210 	ld	a, (hl+)
      0000AD 47               [ 4]  211 	ld	b, a
      0000AE 4E               [ 8]  212 	ld	c, (hl)
      0000AF 21r51r01         [12]  213 	ld	hl, #(_mouse_metasprites + 6) + 1
      0000B2 3A               [ 8]  214 	ld	a,	(hl-)
                                    215 ;	spillPairReg hl
                                    216 ;C:/gbdk/include/gb/metasprites.h:140: __current_metasprite = metasprite;
      0000B3 5E               [ 8]  217 	ld	e, (hl)
      0000B4 57               [ 4]  218 	ld	d, a
      0000B5 21r00r00         [12]  219 	ld	hl, #___current_metasprite
      0000B8 7B               [ 4]  220 	ld	a, e
      0000B9 22               [ 8]  221 	ld	(hl+), a
      0000BA 72               [ 8]  222 	ld	(hl), d
                                    223 ;C:/gbdk/include/gb/metasprites.h:141: __current_base_tile = base_tile;
      0000BB 21r00r00         [12]  224 	ld	hl, #___current_base_tile
      0000BE 36 00            [12]  225 	ld	(hl), #0x00
                                    226 ;C:/gbdk/include/gb/metasprites.h:142: return __move_metasprite(base_sprite, x, y);
      0000C0 C5               [16]  227 	push	bc
      0000C1 33               [ 8]  228 	inc	sp
      0000C2 61               [ 4]  229 	ld	h, c
      0000C3 2E 00            [ 8]  230 	ld	l, #0x00
      0000C5 E5               [16]  231 	push	hl
      0000C6 CDr00r00         [24]  232 	call	___move_metasprite
      0000C9 E8 03            [16]  233 	add	sp, #3
                                    234 ;src\player.c:85: break;
      0000CB 18 4A            [12]  235 	jr	00112$
                                    236 ;src\player.c:86: case left:
      0000CD                        237 00104$:
                                    238 ;src\player.c:87: move_metasprite_vflip(mouse_metasprites[2], 0, 0, ptr->x, ptr->y);
      0000CD F8 01            [12]  239 	ldhl	sp,	#1
      0000CF 2A               [ 8]  240 	ld	a, (hl+)
      0000D0 47               [ 4]  241 	ld	b, a
      0000D1 4E               [ 8]  242 	ld	c, (hl)
      0000D2 21r4Fr01         [12]  243 	ld	hl, #(_mouse_metasprites + 4) + 1
      0000D5 3A               [ 8]  244 	ld	a,	(hl-)
                                    245 ;	spillPairReg hl
                                    246 ;C:/gbdk/include/gb/metasprites.h:169: __current_metasprite = metasprite;
      0000D6 5E               [ 8]  247 	ld	e, (hl)
      0000D7 57               [ 4]  248 	ld	d, a
      0000D8 21r00r00         [12]  249 	ld	hl, #___current_metasprite
      0000DB 7B               [ 4]  250 	ld	a, e
      0000DC 22               [ 8]  251 	ld	(hl+), a
      0000DD 72               [ 8]  252 	ld	(hl), d
                                    253 ;C:/gbdk/include/gb/metasprites.h:170: __current_base_tile = base_tile;
      0000DE 21r00r00         [12]  254 	ld	hl, #___current_base_tile
      0000E1 36 00            [12]  255 	ld	(hl), #0x00
                                    256 ;C:/gbdk/include/gb/metasprites.h:171: return __move_metasprite_vflip(base_sprite, x - 8, y);
      0000E3 79               [ 4]  257 	ld	a, c
      0000E4 C6 F8            [ 8]  258 	add	a, #0xf8
      0000E6 C5               [16]  259 	push	bc
      0000E7 33               [ 8]  260 	inc	sp
      0000E8 67               [ 4]  261 	ld	h, a
      0000E9 2E 00            [ 8]  262 	ld	l, #0x00
      0000EB E5               [16]  263 	push	hl
      0000EC CDr00r00         [24]  264 	call	___move_metasprite_vflip
      0000EF E8 03            [16]  265 	add	sp, #3
                                    266 ;src\player.c:88: break;
      0000F1 18 24            [12]  267 	jr	00112$
                                    268 ;src\player.c:89: default:
      0000F3                        269 00105$:
                                    270 ;src\player.c:90: move_metasprite_vflip(mouse_metasprites[2], 0, 0, ptr->x, ptr->y);
      0000F3 F8 01            [12]  271 	ldhl	sp,	#1
      0000F5 2A               [ 8]  272 	ld	a, (hl+)
      0000F6 47               [ 4]  273 	ld	b, a
      0000F7 4E               [ 8]  274 	ld	c, (hl)
      0000F8 21r4Fr01         [12]  275 	ld	hl, #(_mouse_metasprites + 4) + 1
      0000FB 3A               [ 8]  276 	ld	a,	(hl-)
                                    277 ;	spillPairReg hl
                                    278 ;C:/gbdk/include/gb/metasprites.h:169: __current_metasprite = metasprite;
      0000FC 5E               [ 8]  279 	ld	e, (hl)
      0000FD 57               [ 4]  280 	ld	d, a
      0000FE 21r00r00         [12]  281 	ld	hl, #___current_metasprite
      000101 7B               [ 4]  282 	ld	a, e
      000102 22               [ 8]  283 	ld	(hl+), a
      000103 72               [ 8]  284 	ld	(hl), d
                                    285 ;C:/gbdk/include/gb/metasprites.h:170: __current_base_tile = base_tile;
      000104 21r00r00         [12]  286 	ld	hl, #___current_base_tile
      000107 36 00            [12]  287 	ld	(hl), #0x00
                                    288 ;C:/gbdk/include/gb/metasprites.h:171: return __move_metasprite_vflip(base_sprite, x - 8, y);
      000109 79               [ 4]  289 	ld	a, c
      00010A C6 F8            [ 8]  290 	add	a, #0xf8
      00010C C5               [16]  291 	push	bc
      00010D 33               [ 8]  292 	inc	sp
      00010E 67               [ 4]  293 	ld	h, a
      00010F 2E 00            [ 8]  294 	ld	l, #0x00
      000111 E5               [16]  295 	push	hl
      000112 CDr00r00         [24]  296 	call	___move_metasprite_vflip
      000115 E8 03            [16]  297 	add	sp, #3
                                    298 ;src\player.c:92: }
      000117                        299 00112$:
                                    300 ;src\player.c:93: }
      000117 E8 03            [16]  301 	add	sp, #3
      000119 C9               [16]  302 	ret
      00011A                        303 _mouse_down:
      00011A F0                     304 	.db #0xf0	; -16
      00011B F8                     305 	.db #0xf8	; -8
      00011C 00                     306 	.db #0x00	; 0
      00011D 00                     307 	.db #0x00	; 0
      00011E 00                     308 	.db #0x00	;  0
      00011F 08                     309 	.db #0x08	;  8
      000120 02                     310 	.db #0x02	; 2
      000121 00                     311 	.db #0x00	; 0
      000122 80                     312 	.db #0x80	; -128
      000123 00                     313 	.db #0x00	;  0
      000124 00                     314 	.db #0x00	; 0
      000125 00                     315 	.db #0x00	; 0
      000126                        316 _mouse_up:
      000126 F0                     317 	.db #0xf0	; -16
      000127 F8                     318 	.db #0xf8	; -8
      000128 0C                     319 	.db #0x0c	; 12
      000129 00                     320 	.db #0x00	; 0
      00012A 00                     321 	.db #0x00	;  0
      00012B 08                     322 	.db #0x08	;  8
      00012C 0E                     323 	.db #0x0e	; 14
      00012D 00                     324 	.db #0x00	; 0
      00012E 80                     325 	.db #0x80	; -128
      00012F 00                     326 	.db #0x00	;  0
      000130 00                     327 	.db #0x00	; 0
      000131 00                     328 	.db #0x00	; 0
      000132                        329 _mouse_right0:
      000132 F0                     330 	.db #0xf0	; -16
      000133 F8                     331 	.db #0xf8	; -8
      000134 04                     332 	.db #0x04	; 4
      000135 00                     333 	.db #0x00	; 0
      000136 00                     334 	.db #0x00	;  0
      000137 08                     335 	.db #0x08	;  8
      000138 06                     336 	.db #0x06	; 6
      000139 00                     337 	.db #0x00	; 0
      00013A 80                     338 	.db #0x80	; -128
      00013B 00                     339 	.db #0x00	;  0
      00013C 00                     340 	.db #0x00	; 0
      00013D 00                     341 	.db #0x00	; 0
      00013E                        342 _mouse_right1:
      00013E F0                     343 	.db #0xf0	; -16
      00013F F8                     344 	.db #0xf8	; -8
      000140 08                     345 	.db #0x08	; 8
      000141 00                     346 	.db #0x00	; 0
      000142 00                     347 	.db #0x00	;  0
      000143 08                     348 	.db #0x08	;  8
      000144 0A                     349 	.db #0x0a	; 10
      000145 00                     350 	.db #0x00	; 0
      000146 80                     351 	.db #0x80	; -128
      000147 00                     352 	.db #0x00	;  0
      000148 00                     353 	.db #0x00	; 0
      000149 00                     354 	.db #0x00	; 0
      00014A                        355 _mouse_metasprites:
      00014Ar1Ar01                  356 	.dw _mouse_down
      00014Cr26r01                  357 	.dw _mouse_up
      00014Er32r01                  358 	.dw _mouse_right0
      000150r3Er01                  359 	.dw _mouse_right1
                                    360 	.area _CODE
                                    361 	.area _INITIALIZER
      000000                        362 __xinit__joypadCurrent:
      000000 00                     363 	.db #0x00	; 0
      000001                        364 __xinit__joypadPrevious:
      000001 00                     365 	.db #0x00	; 0
                                    366 	.area _CABS (ABS)
